<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>Pepper: Monitoring the progress</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Pepper
   &#160;<span id="projectnumber">3.0.1-SNAPSHOT</span>
   </div>
   <div id="projectbrief">A highly extensible plattform for conversion and manipulationoflinguisticdatabetweenanunboundsetofformats.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('feedback.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Monitoring the progress </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>What could be more annoying than a not responding program and you do not know if it is still working or not? A conversion job could take some time, which is already frustrating enough for the user. Therefore we want to keep the frustration of users as small as possible and give them a precise response about the progress of the conversion job.</p>
<p>Although Pepper is providing a mechanism to make the monitoring of the progress as simple as possible, a rest work for you remains to do. But don't get afraid, monitoring the progress just means the call of a single method.</p>
<p>When you are using the default mapping mechanism by implementing the interface <a class="el" href="interfaceorg_1_1corpus__tools_1_1pepper_1_1modules_1_1_pepper_mapper.html">org.corpus_tools.pepper.modules.PepperMapper</a>, this class provides the methods addProgress(Double progress) and setProgress(Double progress) for this purpose. Both methods have a different semantic. addProgress(Double progress) will add the passed value to the current progress, whereas setProgress(Double progress) will override the entire progress. The passed value for progress must be a value between 0 for 0% and 1 for 100%. It is up to you to call one of the methods in your code and to estimate the progress. Often it is easier not to estimate the time needed for the process, than to divide the total process costs in several steps and to return a progress for each step. For instance the following sample separates the entire mapping process into five steps, which get the same costs of process.</p>
<div class="fragment"><div class="line"><span class="comment">//...</span></div>
<div class="line"><span class="comment">//map all STextualDS objects (one fifth if total process is done)</span></div>
<div class="line">addProgress(0.2);</div>
<div class="line"><span class="comment">//map all SToken objects (two fifth if total process is done)</span></div>
<div class="line">addProgress(0.2);</div>
<div class="line"><span class="comment">//map all SSpan objects (three fifth if total process is done)</span></div>
<div class="line">addProgress(0.2);</div>
<div class="line"><span class="comment">//map all SStruct objects (four fifth if total process is done)</span></div>
<div class="line">addProgress(0.2);</div>
<div class="line"><span class="comment">//map all SPointingRelation objects </span></div>
<div class="line"><span class="comment">//(process done, should be one of the last lines)</span></div>
<div class="line">addProgress(0.2);</div>
<div class="line"><span class="comment">//...</span></div>
</div><!-- fragment --><blockquote class="doxtable">
<p><b>Note</b></p>
<p>When using <a class="el" href="interfaceorg_1_1corpus__tools_1_1pepper_1_1modules_1_1_pepper_mapper.html">org.corpus_tools.pepper.modules.PepperMapper</a>, you only have to take care about the progress of the current <code>SDocument</code> or <code>SCorpus</code> object you are processing. The aggregation of all currently processed objects (<code>SDocument</code> and <code>SCorpus</code>) will be done automatically.</p>
<p></p>
</blockquote>
<p>In case you do not want to use the default mechanism, you need to override the methods <a class="el" href="interfaceorg_1_1corpus__tools_1_1pepper_1_1modules_1_1_pepper_module.html#ae65f26a8a116be23c176cceb16f53e27" title="This method is invoked by the Pepper framework, to get the current progress concerning the SDocument ...">org.corpus_tools.pepper.modules.PepperModule.getProgress(String globalId)</a> and <a class="el" href="interfaceorg_1_1corpus__tools_1_1pepper_1_1modules_1_1_pepper_module.html#ad964f9ee65b86795d88261a7555d46ac" title="This method is invoked by the Pepper framework, to get the current total progress of all SDocument ob...">org.corpus_tools.pepper.modules.PepperModule.getProgress()</a>. The method getProgress(SElementId sDocumentId) shall return the progress of the <code>SDocument</code> or <code>SCorpus</code> object corresponding to the passed id. Whereas the method getProgress() shall return the aggregated progress of all <code>SDocument</code> and <code>SCorpus</code> objects currently processed by your module.</p>
<h2>Logging </h2>
<p>Another form of Monitoring is the logging, which could be used for passing messages to the user or passing messages to a file for debugging. The logging task in Pepper is handled by the SLF4J framework (see: <a href="http://www.slf4j.org/">http://www.slf4j.org/</a>). SLF4J is a logging framework, which provides an abstraction for several other logging frameworks like log4j (see: <a href="http://logging.apache.org/log4j/2.x/">http://logging.apache.org/log4j/2.x/</a>) or java.util.logging. Via creating a static logger object you can log several debug levels: trace, debug, info and error. The following snippet shows the instantiation of the static logger and its usage. </p>
<div class="fragment"><div class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Logger logger= LoggerFactory</div>
<div class="line">        .getLogger(MyImporter.class);</div>
<div class="line">logger.trace(<span class="stringliteral">&quot;messages for the implementor&quot;</span>);</div>
<div class="line">logger.debug(<span class="stringliteral">&quot;message for the implementor and user&quot;</span>);</div>
<div class="line">logger.info(<span class="stringliteral">&quot;messages for the user&quot;</span>);</div>
<div class="line">logger.error(<span class="stringliteral">&quot;messages in case of an exception&quot;</span>);</div>
</div><!-- fragment --><h2>Error handling </h2>
<p>Another important aspect of monitoring, is the monitoring when an error occurred. Even when the module crashes and the conversion could not be ended successfully, the user needs a feedback of what has happened. The main question would be is it a bug in code or a bug in the data. In both cases, the user needs a precise description. Either to notify you, the module developer, or to find the bug in the data on her or his own. And unfortunately just a <code>NullPointerException</code> is not very useful to the user and is very frustrating.</p>
<p>Pepper provides a hierarchy of Exception classes to be used for different purposes, for instance to describe problems in customization properties, the data or general problems in module.</p>
<div class="image">
<img src="exceptionClassDiagram.png" alt="exceptionClassDiagram.png"/>
<div class="caption">
corpus-structure represented in file structure</div></div>
<p> The main and general class <a class="el" href="classorg_1_1corpus__tools_1_1pepper_1_1modules_1_1exceptions_1_1_pepper_module_exception.html">org.corpus_tools.pepper.modules.exceptions.PepperModuleException</a> can be used in case the exception does not match to one of the more specific types. When initializing a <a class="el" href="classorg_1_1corpus__tools_1_1pepper_1_1modules_1_1exceptions_1_1_pepper_module_exception.html">org.corpus_tools.pepper.modules.exceptions.PepperModuleException</a> or one of its subclasses, you can pass a <a class="el" href="interfaceorg_1_1corpus__tools_1_1pepper_1_1modules_1_1_pepper_module.html">org.corpus_tools.pepper.modules.PepperModule</a> or a <a class="el" href="interfaceorg_1_1corpus__tools_1_1pepper_1_1modules_1_1_pepper_mapper.html">org.corpus_tools.pepper.modules.PepperMapper</a> object. The exception itself will expand the error message with the modules name etc. A more detailed description of the exception classes could be found in the JavaDoc.</p>
<p>When an exception was thrown for a single document, Pepper will not abort the entire conversion process. Pepper will set the status of this document to org.corpus_tools.pepper.common.DOCUMENT_STATUS.FAILED and will remove it from the rest of the workflow, so that modules coming afterwards will not process the corrupted document. Pepper will provide a feedback to the user containing the error message provided by the module. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="module_developers.html">Pepper module developers</a></li>
    <li class="footer">Generated on Fri Mar 25 2016 14:02:50 for Pepper by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.6 </li>
  </ul>
</div>
</body>
</html>
