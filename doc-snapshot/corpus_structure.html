<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>Pepper: Im- and exporting corpus-structure</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Pepper
   &#160;<span id="projectnumber">3.0.1-SNAPSHOT</span>
   </div>
   <div id="projectbrief">A highly extensible plattform for conversion and manipulationoflinguisticdatabetweenanunboundsetofformats.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('corpus_structure.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Im- and exporting corpus-structure </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>The classes org.corpus_tools.pepper.modules.impl.PepperImporterImpl and org.corpus_tools.pepper.modules.impl.PepperExporterImpl provide an automatic mechanism to im- or export the corpus-structure. This mechanism is adaptable step by step, according to your specific purpose. Since many formats do not care about the corpus-structure and they only encode the document-structure, the corpus-structure is simultaneous to the file structure of a corpus.</p>
<p>Pepper's default mapping maps the root-folder to a root-corpus (<code>SCorpus</code> object). A sub-folder then corresponds to a sub-corpus (<code>SCorpus</code> object). The relation between super- and sub-corpus, is represented as a <code>SCorpusRelation</code> object. Following the assumption, that files contain the document-structure, there is one <code>SDocument</code> corresponding to each file in a sub-folder. The <code>SCorpus</code> and the <code>SDocument</code> objects are linked with a <code>SCorpusDocumentRelation</code>. To get an impression of the described mapping, the next two figures show the file structure and the corresponding corpus structure.</p>
<div class="image">
<img src="importCorpusStructure.png" alt="importCorpusStructure.png"/>
<div class="caption">
file structure</div></div>
<div class="image">
<img src="corpus-structure.png" alt="corpus-structure.png"/>
<div class="caption">
corpus structure</div></div>
<p> For keeping the correspondance between the corpus-structure and the file structure, both the im- and the exporter make use of a map, which can be accessed via org.corpus_tools.pepper.modules.impl.PepperImporterImpl.getSElementId2ResourceTable().</p>
<p>|----------------------------&mdash;|-------------------------------&mdash;| | salt://corp1 | /superCorpus | | salt://corp1/subCorpus1 | /superCorpus/subCorpus1 | | salt://corp1/subCorpus1#doc1 | /superCorpus/subCorpus1/doc1.xml | | salt://corp1/subCorpus1#doc2 | /superCorpus/subCorpus1/doc2.xml | | salt://corp1/subCorpus2 | /superCorpus/subCorpus2 | | salt://corp1/subCorpus2#doc3 | /superCorpus/subCorpus2/doc3.xml | | salt://corp1/subCorpus2#doc4 | /superCorpus/subCorpus2/doc4.xml |</p>
<p>Other formats do not encode the document-structure in just one file, they use a bunch of files instead. In that case the folder containing all the files (let's call it leaf-folder) corresponds to a <code>SDocument</code> object.</p>
<div class="image">
<img src="importCorpusStructure2.png" alt="importCorpusStructure2.png"/>
<div class="caption">
file structure, where one document is encoded in multiple files</div></div>
<p> In the following two sections, we are going to describe the import and the export mechanism separately.</p>
<h2>Importing the corpus-structure </h2>
<p>The default mechanism for importing a corpus-structure is implemented in the method: </p>
<pre class="fragment">importCorpusStructure(SCorpusGraph corpusGraph)
</pre><p>For totally changing the default behavior just override this method. To adapt the behavior as described in the following, this has to be done before the method '<em>importCorpusStructure()</em>' was called, so for instance in the constructor or in method: </p>
<pre class="fragment">isReadyToStart()
</pre><p>Back to figure ?, the import mechanism traverses the file structure beginning at the super-folder via the sub-folders to the files and creates a <code>SElementId</code> object corresponding to each folder or file and puts them into the map of table ?. This map is necessary for instance to retrieve the physical location of a document-structure during the mapping and can be set as shown in the following snippet: </p>
<pre class="fragment">public PepperMapper createPepperMapper(SElementId sElementId){
    ...
    mapper.setResourceURI(getSElementId2ResourceTable().get(sElementId));
    ...
}
</pre><p>The import mechanism can be adapted by two parameters (or more precisly two lists). An ignore list containing file endings, which are supposed to be ignored during the import and a list of file endings which are supposed to be used for the import.[3] Now let's show some code for adapting. The following snippet is placed into the method 'isReadyToStart()', but even could be located inside the constructor: </p>
<pre class="fragment">public boolean isReadyToStart(){
    ...
    //option 1
    getSDocumentEndings().add(ENDING_XML);
    getSDocumentEndings().add(ENDING_TAB);
    //option 2
    getSDocumentEndings().add(ENDING_ALL_FILES);
    getIgnoreEndings().add(ENDING_TXT)
    //option 3
    getSDocumentEndings().add(ENDING_LEAF_FOLDER);
    ...
}
</pre><p>In general the parameter of the method '<em>getSDocumentEndings()</em>' is just a String, but there are some predefined endings you can use. The two lines marked as option 1, will add the endings 'xml' and 'tab' to the list of file endings to be imported. That means, that all files having one of these endings will be read and mapped to a document-structure. The first line of option 2 means to read each file, no matter what's its ending. But the following line excludes all files having the ending 'txt'. Last but not least we look at option 3, which is supposed to treat leaf-folders as document-structures and to create one <code>SDocument</code> object for each leaf-folder and not for each file, as mentioned in figure ?.</p>
<h2>Exporting the corpus-structure </h2>
<p>Similar to the corpus-structure import, we provide a default behavior for the export and possibilities for adaption. The corpus-structure export is handled in the method: </p>
<pre class="fragment">exportCorpusStructure()
</pre><p>It is invoked on top of the method '<em>start()</em>' of the <code>PepperExporter</code>. For totally changing the default behavior just override this method. The aim of this method is to fill the map of corresponding corpus-structure and file structure (see table ?).</p>
<blockquote class="doxtable">
<p><b>Note</b></p>
<p>The file structure is automatically created, there are just <code>URI</code>s pointing to the virtual file or folder. The creation of the file or folder has to be done by the Pepper module itself in method 'mapSCorpus()' or 'mapSDocument()'.</p>
<p></p>
</blockquote>
<p>To adapt the creation of this 'virtual' file structure, you first have to choose the mode of export. You can do this for instance in method 'readyToStart()', as shown in the following snippet. But even in the constructor as well. </p>
<pre class="fragment">public boolean isReadyToStart(){
    ...
    //option 1
    setExportMode(EXPORT_MODE.NO_EXPORT);
    //option 2
    setExportMode(EXPORT_MODE.CORPORA_ONLY);
    //option 3
    setExportMode(EXPORT_MODE.DOCUMENTS_IN_FILES);
    setSDocumentEnding(ENDING_TAB);
    ..
}
</pre><p>In this snippet, option 1 means that nothing will be mapped. Option 2 means that only <code>SCorpus</code> objects are mapped to a folder and <code>SDocument</code> objects will be ignored. And option 3 means that <code>SCorpus</code> objects are mapped to a folder and <code>SDocument</code> objects are mapped to a file. The ending of that file can be determined by passing the ending with method '<em>setSDocumentEnding(String)</em>'. In the given snippet a <code>URI</code> having the ending '<em>tab</em>' is created for each <code>SDocument</code>. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="module_developers.html">Pepper module developers</a></li>
    <li class="footer">Generated on Sun Mar 20 2016 23:21:14 for Pepper by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.6 </li>
  </ul>
</div>
</body>
</html>
